

```python
#用numpy进行线性代数运算
import numpy as np
#用numpy求矩阵的逆
#1.创建一个示例矩阵，利用mat（）函数创建一个示例矩阵：
A=np.mat("2 4 6;4 2 6;10 -4 18")
A
```




    matrix([[ 2,  4,  6],
            [ 4,  2,  6],
            [10, -4, 18]])




```python
#2.求矩阵的逆
#利用inv（）子例程来计算逆矩阵
inverse=np.linalg.inv(A)
inverse
```




    matrix([[-0.41666667,  0.66666667, -0.08333333],
            [ 0.08333333,  0.16666667, -0.08333333],
            [ 0.25      , -0.33333333,  0.08333333]])




```python
#3.用矩阵乘法进行验算
A*inverse
```




    matrix([[  1.00000000e+00,   0.00000000e+00,   0.00000000e+00],
            [  0.00000000e+00,   1.00000000e+00,   0.00000000e+00],
            [  0.00000000e+00,   8.88178420e-16,   1.00000000e+00]])




```python
#用numpy解线性方程组
#创建矩阵B和数组b
B=np.mat("1 -2 1;0 2 -8;-4 5 9")
B
```




    matrix([[ 1, -2,  1],
            [ 0,  2, -8],
            [-4,  5,  9]])




```python
b=np.array([0,8,-9])
b
```




    array([ 0,  8, -9])




```python
#调用solve()函数
x=np.linalg.solve(B,b)
print("Solution",x)
```

    Solution [ 29.  16.   3.]
    


```python
#求特征值和特征向量
C=np.mat("3 -2;1 0")#计算特征值
np.linalg.eigvals(C)
```




    array([ 2.,  1.])




```python
#利用eig（）函数取得特征值和特征向量
eigenvalues,eigenvectors=np.linalg.eig(C)
eigenvalues
```




    array([ 2.,  1.])




```python
eigenvectors
```




    matrix([[ 0.89442719,  0.70710678],
            [ 0.4472136 ,  0.70710678]])




```python
#验算结果
for i in range(len(eigenvalues)):
    print("Left",np.dot(C,eigenvectors[:,i]))
    print("Right",eigenvalues[i]*eigenvectors[:,i])
    print()
```

    Left [[ 1.78885438]
     [ 0.89442719]]
    Right [[ 1.78885438]
     [ 0.89442719]]
    
    Left [[ 0.70710678]
     [ 0.70710678]]
    Right [[ 0.70710678]
     [ 0.70710678]]
    
    


```python
#用二项分布进行博弈
import numpy as np
import matplotlib.pyplot as plt
cash=np.zeros(10000)
print(cash)
cash[0]=1000
outcome=np.random.binomial(9,0.5,size=len(cash))
print(len(outcome))
for i in range(1,len(cash)):
    if outcome[i]<5:       
        cash[i]=cash[i-1]-1
    elif outcome[i]<10:      
        cash[i]=cash[i-1]+1    
    else:
        raise AssertionError("Unexpected outcome" + outcome)
print(outcome.min(),outcome.max())
plt.plot(np.arange(len(cash)),cash)
plt.show()
```

    [ 0.  0.  0. ...,  0.  0.  0.]
    10000
    0 9
    


![png](output_10_1.png)



```python
outcome=np.random.binomial(9,0.5,20)
print(outcome)
```

    [4 3 5 4 1 5 3 4 4 2 5 2 4 2 4 3 3 4 4 4]
    


```python
#正态分布采样
import numpy as np
import matplotlib.pyplot as plt
N=10000
normal_values=np.random.normal(size=N)
dummy,bins,dummy=plt.hist(normal_values,np.sqrt(N),normed=True,lw=1)
sigma=1
mu=0
plt.plot(bins,1/(sigma*np.sqrt(2*np.pi))*np.exp(-(bins-mu)**2/(2*sigma**2)),lw=2)
plt.show()
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    <ipython-input-19-1ed26bb9afc1> in <module>()
          4 N=10000
          5 normal_values=np.random.normal(size=N)
    ----> 6 dummy,bins,dummy=plt.hist(normal_values,np.sqrt(N),normed=True,lw=1)
          7 sigma=1
          8 mu=0
    

    C:\ProgramData\Anaconda3\lib\site-packages\matplotlib\pyplot.py in hist(x, bins, range, normed, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, hold, data, **kwargs)
       3079                       histtype=histtype, align=align, orientation=orientation,
       3080                       rwidth=rwidth, log=log, color=color, label=label,
    -> 3081                       stacked=stacked, data=data, **kwargs)
       3082     finally:
       3083         ax._hold = washold
    

    C:\ProgramData\Anaconda3\lib\site-packages\matplotlib\__init__.py in inner(ax, *args, **kwargs)
       1895                     warnings.warn(msg % (label_namer, func.__name__),
       1896                                   RuntimeWarning, stacklevel=2)
    -> 1897             return func(ax, *args, **kwargs)
       1898         pre_doc = inner.__doc__
       1899         if pre_doc is None:
    

    C:\ProgramData\Anaconda3\lib\site-packages\matplotlib\axes\_axes.py in hist(***failed resolving arguments***)
       6193             # this will automatically overwrite bins,
       6194             # so that each histogram uses the same bins
    -> 6195             m, bins = np.histogram(x[i], bins, weights=w[i], **hist_kwargs)
       6196             m = m.astype(float)  # causes problems later if it's an int
       6197             if mlast is None:
    

    C:\ProgramData\Anaconda3\lib\site-packages\numpy\lib\function_base.py in histogram(a, bins, range, normed, weights, density)
        726 
        727         # Initialize empty histogram
    --> 728         n = np.zeros(bins, ntype)
        729         # Pre-compute histogram scaling factor
        730         norm = bins / (mx - mn)
    

    TypeError: 'numpy.float64' object cannot be interpreted as an integer



```python
import numpy as np
import matplotlib.pyplot as plt
N=10000
normal_values=np.random.normal(size=N)
dummy,bins,dummy=plt.hist(normal_values,int(np.sqrt(N)),normed=True,lw=1)
sigma=1
mu=0
plt.plot(bins,1/(sigma*np.sqrt(2*np.pi))*np.exp(-(bins-mu)**2/(2*sigma**2)),lw=2)
plt.show()
```


![png](output_13_0.png)



```python
normal_values=np.random.normal(size=20)
normal_values
```




    array([ 0.76030006,  1.0791677 , -0.4439344 ,  0.13876145, -0.04765493,
            0.04669902, -0.29345354,  0.7433968 ,  1.17998715,  1.60724064,
            0.5069445 ,  1.93606731,  0.4757235 ,  0.95059352, -0.05473682,
           -0.22794997, -0.52471566,  1.22801571,  1.26707088,  2.18503091])




```python
import numpy as np
import pandas as pd
from scipy.stats import scoreatpercentile
#data=np.loadtxt("mdrtb1.csv",str,delimiter=',',usecols=(1,),skiprows=1,unpack=True)
data = pd.read_csv('mdrtb.csv',index_col='country')
print(data)
```

                                                        e_mdr_pct_rr_new
    country                                                             
    Afghanistan                                                     85.0
    Albania                                                         25.0
    Algeria                                                        100.0
    American Samoa                                                  83.0
    Andorra                                                          NaN
    Angola                                                          67.0
    Anguilla                                                        88.0
    Antigua and Barbuda                                             79.0
    Argentina                                                       94.0
    Armenia                                                         87.0
    Aruba                                                           79.0
    Australia                                                       71.0
    Austria                                                         98.0
    Azerbaijan                                                      98.0
    Bahamas                                                         33.0
    Bahrain                                                        100.0
    Bangladesh                                                      88.0
    Barbados                                                         NaN
    Belarus                                                         96.0
    Belgium                                                         94.0
    Belize                                                          88.0
    Benin                                                           42.0
    Bermuda                                                          NaN
    Bhutan                                                          90.0
    Bolivia (Plurinational State of)                                88.0
    Bonaire, Saint Eustatius and Saba                               88.0
    Bosnia and Herzegovina                                          67.0
    Botswana                                                        69.0
    Brazil                                                          93.0
    British Virgin Islands                                          79.0
    ...                                                              ...
    Tajikistan                                                      47.0
    Thailand                                                        91.0
    The Former Yugoslav Republic of Macedonia                       75.0
    Timor-Leste                                                     90.0
    Togo                                                            67.0
    Tokelau                                                         83.0
    Tonga                                                           83.0
    Trinidad and Tobago                                             79.0
    Tunisia                                                        100.0
    Turkey                                                          72.0
    Turkmenistan                                                    97.0
    Turks and Caicos Islands                                        79.0
    Tuvalu                                                          83.0
    Uganda                                                          88.0
    Ukraine                                                         97.0
    United Arab Emirates                                            79.0
    United Kingdom of Great Britain and Northern Ir...              87.0
    United Republic of Tanzania                                     85.0
    United States of America                                        80.0
    Uruguay                                                         67.0
    US Virgin Islands                                               79.0
    Uzbekistan                                                      96.0
    Vanuatu                                                          NaN
    Venezuela (Bolivarian Republic of)                              88.0
    Viet Nam                                                        98.0
    Wallis and Futuna Islands                                       83.0
    West Bank and Gaza Strip                                        85.0
    Yemen                                                           74.0
    Zambia                                                          27.0
    Zimbabwe                                                        67.0
    
    [217 rows x 1 columns]
    


```python
print("Max method",data.max())
print("Max function",np.max(data))
print("Min method",data.min())
print("Min function",np.min(data))
print("Mean method",data.mean())
print("Mean function",np.mean(data))
print("Std method",data.std())
print("Std function",np.std(data))
print ("Median",np.median(data))
print("Score at percentile 50",scoreatpercentile(data,50))
```

    Max method e_mdr_pct_rr_new    100.0
    dtype: float64
    Max function e_mdr_pct_rr_new    100.0
    dtype: float64
    Min method e_mdr_pct_rr_new    0.0
    dtype: float64
    Min function e_mdr_pct_rr_new    0.0
    dtype: float64
    Mean method e_mdr_pct_rr_new    76.968421
    dtype: float64
    Mean function e_mdr_pct_rr_new    76.968421
    dtype: float64
    Std method e_mdr_pct_rr_new    18.91275
    dtype: float64
    Std function e_mdr_pct_rr_new    18.862914
    dtype: float64
    Median nan
    Score at percentile 50 83.0
    

    C:\ProgramData\Anaconda3\lib\site-packages\numpy\lib\function_base.py:3858: RuntimeWarning: Invalid value encountered in median
      r = func(a, **kwargs)
    


```python
#数据可视化
import matplotlib.pyplot as plt
import numpy as np
x=np.linspace(0,20)
plt.plot(x,.5+x)
plt.plot(x,1+2*x,'--')
plt.show()
```


![png](output_17_0.png)



```python
#对数图
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
years=df.index.values
counts=df['trans_count'].values
poly=np.polyfit(years,np.log(counts),deg=1)
print("Poly",poly)
plt.semilogy(years,counts,'o')
plt.semilogy(years,np.exp(np.polyval(poly,years)))
plt.show()
```

    Poly [  3.51232166e-01  -6.85246923e+02]
    


![png](output_18_1.png)



```python
years=df.index.values
print(years)
```

    [1971 1972 1974 1975 1976 1978 1979 1981 1982 1983 1984 1985 1986 1987 1988
     1989 1990 1991 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004
     2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017]
    


```python
counts
```




    array([  2.30000000e+03,   3.50000000e+03,   5.40000000e+03,
             3.51000000e+03,   7.50000000e+03,   1.90000000e+04,
             4.85000000e+04,   1.15000000e+04,   9.45000000e+04,
             2.20000000e+04,   1.90000000e+05,   1.05333333e+05,
             3.00000000e+04,   4.13000000e+05,   2.15000000e+05,
             7.45117500e+05,   1.20000000e+06,   6.92500000e+05,
             3.10000000e+06,   1.53948850e+06,   4.00000000e+06,
             4.30000000e+06,   8.15000000e+06,   7.50000000e+06,
             1.60622000e+07,   3.15000000e+07,   4.50000000e+07,
             1.37500000e+08,   1.90066667e+08,   3.52000000e+08,
             1.98500000e+08,   5.55600000e+08,   3.71600000e+08,
             7.33200000e+08,   9.04000000e+08,   1.51166667e+09,
             2.01000000e+09,   2.16062500e+09,   3.01500000e+09,
             3.14500000e+09,   4.94800000e+09,   4.17500000e+09,
             8.44285714e+09])




```python
#散点图
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
gpu=pd.read_csv('gpu_transcount.csv')
gpu=gpu.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
print(df)
years=df.index.values
counts=df['trans_count'].values
gpu_counts=df['gpu_trans_count'].values
cnt_log=np.log(counts)
plt.scatter(years,cnt_log,c=200*years,s=20+200*gpu_counts/gpu_counts.max(),alpha=0.5)
plt.show()
```

           trans_count  gpu_trans_count
    year                               
    1971  2.300000e+03     0.000000e+00
    1972  3.500000e+03     0.000000e+00
    1974  5.400000e+03     0.000000e+00
    1975  3.510000e+03     0.000000e+00
    1976  7.500000e+03     0.000000e+00
    1978  1.900000e+04     0.000000e+00
    1979  4.850000e+04     0.000000e+00
    1981  1.150000e+04     0.000000e+00
    1982  9.450000e+04     0.000000e+00
    1983  2.200000e+04     0.000000e+00
    1984  1.900000e+05     0.000000e+00
    1985  1.053333e+05     0.000000e+00
    1986  3.000000e+04     0.000000e+00
    1987  4.130000e+05     0.000000e+00
    1988  2.150000e+05     0.000000e+00
    1989  7.451175e+05     0.000000e+00
    1990  1.200000e+06     0.000000e+00
    1991  6.925000e+05     0.000000e+00
    1993  3.100000e+06     0.000000e+00
    1994  1.539488e+06     0.000000e+00
    1995  4.000000e+06     0.000000e+00
    1996  4.300000e+06     0.000000e+00
    1997  8.150000e+06     3.500000e+06
    1998  7.500000e+06     0.000000e+00
    1999  1.606220e+07     1.533333e+07
    2000  3.150000e+07     2.500000e+07
    2001  4.500000e+07     5.850000e+07
    2002  1.375000e+08     8.500000e+07
    2003  1.900667e+08     1.260000e+08
    2004  3.520000e+08     1.910000e+08
    2005  1.985000e+08     3.120000e+08
    2006  5.556000e+08     5.325000e+08
    2007  3.716000e+08     4.882500e+08
    2008  7.332000e+08     7.166000e+08
    2009  9.040000e+08     9.155000e+08
    2010  1.511667e+09     1.804143e+09
    2011  2.010000e+09     1.370952e+09
    2012  2.160625e+09     3.121667e+09
    2013  3.015000e+09     3.140000e+09
    2014  3.145000e+09     3.752500e+09
    2015  4.948000e+09     8.450000e+09
    2016  4.175000e+09     7.933333e+09
    2017  8.442857e+09     8.190000e+09
    


![png](output_21_1.png)



```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
gpu=pd.read_csv('gpu_transcount.csv')
gpu=gpu.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
years=df.index.values
counts=df['trans_count'].values
gpu_counts=df['gpu_trans_count'].values
poly=np.polyfit(years,np.log(counts),deg=1)
plt.plot(years,np.polyval(poly,years),label='Fit')
gpu_start=gpu.index.values.min()
y_ann=np.log(df.at[gpu_start,'trans_count'])
ann_str="First GPU/n %d" % gpu_start
plt.annotate(ann_str,xy=(gpu_start,y_ann),arrowprops=dict(arrowstyle="->"),xytext=(-30,+70),textcoords='offset points')
cnt_log=np.log(counts)
plt.scatter(years,cnt_log,c=200*years,s=20+200*gpu_counts/gpu_counts.max(),alpha=0.5,label="Scatter Plot")
plt.legend(loc='upper left')
plt.grid() 
plt.xlabel("Year")
plt.ylabel("Log Transistor Counts",fontsize=16)
plt.title("Moore's Law & Transistor Counts")
plt.show()
```


![png](output_22_0.png)



```python
#三维图
from mpl_toolkits.mplot3d.axes3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
gpu=pd.read_csv('gpu_transcount.csv')
gpu=gpu.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
fig=plt.figure()
ax=Axes3D(fig)
X=df.index.values
Y=np.log(df['trans_count'].values)
X,Y=np.meshgrid(X,Y)
Z=np.log(df['gpu_trans_count'].values)
ax.plot_surface(X,Y,Z)
ax.set_xlabel('Year')
ax.set_ylabel('Log CPU transistor counts')
ax.set_zlabel('Log GPU transistor counts')
ax.set_title("Moore's Law & Transistor Counts")
plt.show()
```

    C:\ProgramData\Anaconda3\lib\site-packages\ipykernel_launcher.py:17: RuntimeWarning: divide by zero encountered in log
    C:\ProgramData\Anaconda3\lib\site-packages\mpl_toolkits\mplot3d\axes3d.py:1685: RuntimeWarning: invalid value encountered in subtract
      v1[which_pt] = np.array(ps2[i1]) - np.array(ps2[i2])
    C:\ProgramData\Anaconda3\lib\site-packages\mpl_toolkits\mplot3d\axes3d.py:1686: RuntimeWarning: invalid value encountered in subtract
      v2[which_pt] = np.array(ps2[i2]) - np.array(ps2[i3])
    C:\ProgramData\Anaconda3\lib\site-packages\numpy\core\numeric.py:1817: RuntimeWarning: invalid value encountered in multiply
      multiply(a1, b2, out=cp0)
    C:\ProgramData\Anaconda3\lib\site-packages\numpy\core\numeric.py:1822: RuntimeWarning: invalid value encountered in subtract
      cp1 -= tmp
    C:\ProgramData\Anaconda3\lib\site-packages\mpl_toolkits\mplot3d\proj3d.py:160: RuntimeWarning: invalid value encountered in true_divide
      txs, tys, tzs = vecw[0]/w, vecw[1]/w, vecw[2]/w
    


![png](output_23_1.png)



```python
#pandas绘图
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
df.plot(logy=True)
df[df['gpu_trans_count']>0].plot(kind='scatter',x='trans_count',y='gpu_trans_count',loglog=True)
plt.show()
```


![png](output_24_0.png)



![png](output_24_1.png)



```python
#时滞图
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
from pandas.tools.plotting import lag_plot
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
gpu=pd.read_csv('gpu_transcount.csv')
gpu=gpu.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
lag_plot(np.log(df['trans_count']))
plt.show()
```

    C:\ProgramData\Anaconda3\lib\site-packages\ipykernel_launcher.py:12: FutureWarning: 'pandas.tools.plotting.lag_plot' is deprecated, import 'pandas.plotting.lag_plot' instead.
      if sys.path[0] == '':
    


![png](output_25_1.png)



```python
#自相关图
import pandas as pd
from pandas.tools.plotting import autocorrelation_plot
df=pd.read_csv('transcount.csv')
df=df.groupby('year').aggregate(np.mean)
gpu=pd.read_csv('gpu_transcount.csv')
gpu=gpu.groupby('year').aggregate(np.mean)
df=pd.merge(df,gpu,how='outer',left_index=True,right_index=True)
df=df.replace(np.nan,0)
autocorrelation_plot(np.log(df['trans_count']))
plt.show()
```

    C:\ProgramData\Anaconda3\lib\site-packages\ipykernel_launcher.py:10: FutureWarning: 'pandas.tools.plotting.autocorrelation_plot' is deprecated, import 'pandas.plotting.autocorrelation_plot' instead.
      # Remove the CWD from sys.path while we load stuff.
    


![png](output_26_1.png)

